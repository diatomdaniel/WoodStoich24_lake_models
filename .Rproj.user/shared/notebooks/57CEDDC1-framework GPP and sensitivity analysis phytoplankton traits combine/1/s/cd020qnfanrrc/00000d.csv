"0","# subset data set and calculate C:N:P"
"0","seston.cnp <- np.runs.df[np.runs.df$model == ""dynamic"",] %>%"
"0","  mutate(""C:N"" = 1/QN1,""C:P"" = 1/QP1, ""N:P"" = QN1/QP1, NP_inflow = Nin/Pin) %>%"
"0","  select(`C:N`, `C:P`, `N:P`,Pin, NP_inflow, species, GPP) %>%"
"0","  gather(""seston"", ""value"", -Pin, -NP_inflow, -species, -GPP) %>%"
"0","  mutate(seston = factor(seston, levels = c(""C:N"", ""C:P"", ""N:P"")))"
"0",""
"0",""
"0","# create plot manually"
"0","plt.seston.cnp <- ggplot() + "
"0","  # average"
"0","  geom_line(data = seston.cnp[seston.cnp$species == ""average"",],"
"0","            aes(x = NP_inflow, y = value, col = Pin, group = Pin), lwd = .75) +"
"0","  geom_point(data = seston.cnp[seston.cnp$species == ""average"",],"
"0","             aes(x = NP_inflow, y = value,fill = Pin, pch = species),"
"0","             pch = 21, size = 2, col = ""white"") +"
"0","  # diatoms"
"0","  geom_line(data = seston.cnp[seston.cnp$species == ""diatoms"",],"
"0","            aes(x = NP_inflow, y = value, col = Pin, group = Pin), lwd = .75) +"
"0","  geom_point(data = seston.cnp[seston.cnp$species == ""diatoms"",],"
"0","             aes(x = NP_inflow, y = value,fill = Pin, pch = species),"
"0","             pch = 22, size = 2, col = ""white"") +"
"0","  # green-algae"
"0","  geom_line(data = seston.cnp[seston.cnp$species == ""greens"",],"
"0","            aes(x = NP_inflow, y = value, col = Pin, group = Pin), lwd = .75) +"
"0","  geom_point(data = seston.cnp[seston.cnp$species == ""greens"",],"
"0","             aes(x = NP_inflow, y = value,fill = Pin, pch = species),"
"0","             pch = 23, size = 2, col = ""white"") +"
"0","  # cyanobacteria"
"0","  geom_line(data = seston.cnp[seston.cnp$species == ""cyanos"",],"
"0","            aes(x = NP_inflow, y = value, col = Pin, group = Pin), lwd = .75) +"
"0","  geom_point(data = seston.cnp[seston.cnp$species == ""cyanos"",],"
"0","             aes(x = NP_inflow, y = value,fill = Pin, pch = species),"
"0","             pch = 24, size = 2, col = ""white"") +"
"0","  #  # Redfield"
"0","  # geom_vline(xintercept =  c(16*14.007/30.974), "
"0","  #             lty = ""dashed"", col = ""white"", lwd = 1) +"
"0","  # # Downing and McCauley"
"0","  # geom_vline(xintercept = c(14, 30), "
"0","  #             lty = ""dashed"", col = ""black"", lwd = 1) + "
"0","  facet_wrap(seston~., scales = ""free_y"") + "
"0","  labs(x = ""N:P inflow (mass)"","
"0","       y = ""Cell C:N:P (mass)"","
"0","       col = expression(""Inflow P ug L""^-1), "
"0","       fill = NULL) +"
"0","  scale_fill_viridis_c() + "
"0","  scale_color_viridis_c() + "
"0","  scale_shape_manual("
"0","    values = c(""21"" = ""average"", ""22"" = ""diatoms"", ""23"" = ""greens"", ""24"" = ""cyanos"")) +"
"0","  guides(fill = ""none"") "
"0","plt.seston.cnp"
