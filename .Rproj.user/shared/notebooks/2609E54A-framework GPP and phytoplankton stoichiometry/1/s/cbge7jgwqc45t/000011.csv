"0",""
"0","# nutrient loads"
"0","# N, P = 5 to 1000 mg L^-1; 1 mg L^-1 = 1000 mg m^-1"
"0","# 100 for now, will increase later"
"0","# loads"
"0","# Olson&Jones use 20 to 500 for P. Use similar values"
"0","# for TP: TP from 2018-219 NLA stream assement ranges from 2 to 950 ugL with 25th and 7th percentiles of 23 and 133 ugL. DG, August 2024"
"0","# for TN: TN from 2018-2019 NLA Stream Assessment ranges from 22 to 22,000 ugL with 25th and 75th percentiles of 300 and 14,000 ug L; DG, August 2024"
"0","exp1.loads <- expand.grid(Pin = seq(20, 500, 50 ) ,"
"0","                     Nin = seq(100,15000,500))"
"0",""
"0","## michaelis-menten model"
"0","# apply over scenarios"
"0","sys.time1 <- Sys.time()"
"0","exp1.mich <- lapply(1:nrow(exp1.loads), function(i) {"
"0","  params.mich[""Pin""] = exp1.loads[i, ""Pin""]"
"0","  params.mich[""Nin""] = exp1.loads[i, ""Nin""]"
"0","  y <- c(""A1"" = 100,"
"0","         ""P"" = exp1.loads[i, ""Pin""],"
"0","         ""N"" = exp1.loads[i, ""Nin""])"
"0","  "
"0","  run <- ode(y, times, parms = params.mich, func = mich.single)"
"0","  return(run[max(times),])"
"0","  "
"0","})"
"0","sys.time2 <- Sys.time()"
"0","sys.time2 - sys.time1"
"1","Time difference of "
"1",""
"1","20.91714"
"1",""
"1"," "
"1",""
"1","secs"
"1",""
"1","
"
"0","exp1.mich <- do.call(rbind, exp1.mich)"
"0","exp1.mich <- as_data_frame(exp1.mich)"
"0","exp1.mich$Pin <- exp1.loads$Pin"
"0","exp1.mich$Nin <- exp1.loads$Nin"
"0",""
"0","## droop model"
"0","# apply over scearions"
"0","exp1.droop <- lapply(1:nrow(exp1.loads), function(i) {"
"0","  params.droop[""Pin""] = exp1.loads[i, ""Pin""]"
"0","  params.droop[""Nin""] = exp1.loads[i, ""Nin""]"
"0","  y <- c(""A1"" = 100,"
"0","         ""P"" = exp1.loads[i, ""Pin""],"
"0","         ""N"" = exp1.loads[i, ""Nin""],"
"0","         ""QP1"" = 0.015,"
"0","         ""QN1"" = 0.1)"
"0","  "
"0","  run <- ode(y, times, parms = params.droop, func = droop.single)"
"0","  return(run[max(times),])"
"0","  "
"0","})"
"0",""
"0","exp1.droop <- do.call(rbind, exp1.droop)"
"0","exp1.droop <- as_data_frame(exp1.droop)"
"0","exp1.droop$Pin <- exp1.loads$Pin"
"0","exp1.droop$Nin <- exp1.loads$Nin"
"0",""
"0","## combine data sets for plotting"
"0","exp1.data <- bind_rows("
"0","  exp1.mich %>% mutate(model = ""Michaelis-Menten""),"
"0","  exp1.droop %>% mutate(model = ""Droop"")"
"0",") %>%"
"0","  mutate(model = factor(model, levels = c(""Michaelis-Menten"", ""Droop"")))"
"0",""
"0",""
