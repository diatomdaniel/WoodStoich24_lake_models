"0",""
"0","# nutrient loads"
"0","# P = 0.005 to 0.150 g m^-3 = 5 to 150 mg m^-3"
"0","# N:P = 22.61, 13.57, 9.04, 7.24, 4.52, 2.26  by mass"
"0","exp3.loads2 <- expand.grid(Pin = seq(5, 500,10),"
"0","                                NP_inflow = c(90.44, 22.61, 7.24, 2.26))"
"0","exp3.loads2$Nin <- exp3.loads2$Pin * exp3.loads2$NP_inflow"
"0",""
"0","## michaelis-menten model"
"0","# apply over scenarios and algal groups"
"0","exp.3.mich2 <-  lapply(list(diatoms.mich, greens.mich, cyanos.mich), function(x) {"
"0","  params <- x"
"0","  lapply(1:nrow(exp3.loads2), function(i) {"
"0","    params[""Pin""] = exp3.loads2[i, ""Pin""]"
"0","    params[""Nin""] = exp3.loads2[i, ""Nin""]"
"0","    y <- c(""A1"" = 100, ""P"" = exp3.loads2[i, ""Pin""],""N"" = exp3.loads2[i, ""Nin""])"
"0","    run <- ode(y, times, parms = params, func = mich.single)"
"0","    return(run[max(times),])"
"0","  })"
"0","})"
"0","exp3.mich2.diatoms <- as_data_frame(do.call(rbind, exp.3.mich2[[1]]))"
"0","exp3.mich2.greens <- as_data_frame(do.call(rbind, exp.3.mich2[[2]]))"
"0","exp3.mich2.cyanos <- as_data_frame(do.call(rbind, exp.3.mich2[[3]]))"
"0",""
"0","## droop model"
"0","# apply over scenarios and algal groups"
"0","exp.3.droop2 <-  lapply(list(diatoms.droop, greens.droop, cyanos.droop), function(x) {"
"0","  params <- x"
"0","  lapply(1:nrow(exp3.loads2), function(i) {"
"0","    params[""Pin""] = exp3.loads2[i, ""Pin""]"
"0","    params[""Nin""] = exp3.loads2[i, ""Nin""]"
"0","    y <- c(""A1"" = 100, ""P"" = exp3.loads2[i, ""Pin""],""N"" = exp3.loads2[i, ""Nin""],"
"0","           ""QP1"" = 0.015, ""QN1"" = 0.1)"
"0","    run <- ode(y, times, parms = params, func = droop.single)"
"0","    return(run[max(times),])"
"0","  })"
"0","})"
"0","exp3.droop2.diatoms <- as_data_frame(do.call(rbind, exp.3.droop2[[1]]))"
"0","exp3.droop2.greens <- as_data_frame(do.call(rbind, exp.3.droop2[[2]]))"
"0","exp3.droop2.cyanos <- as_data_frame(do.call(rbind, exp.3.droop2[[3]]))"
"0",""
"0","# combine everything into a data frame"
"0","exp3.data2 <- bind_rows("
"0","  exp3.mich2.diatoms, exp3.mich2.greens, exp3.mich2.cyanos,"
"0","  exp3.droop2.diatoms, exp3.droop2.greens, exp3.droop2.cyanos"
"0",") %>%"
"0","  mutate(model = rep(c(""Michaelis-Menten"", ""Droop""), each = nrow(exp3.loads2) * 3), "
"0","         species = rep(c(""Diatoms"", ""Greens"", ""Cyanos"", ""Diatoms"", ""Greens"", ""Cyanos""), "
"0","                       each = nrow(exp3.loads2)),"
"0","         Pin = rep(exp3.loads2$Pin, 6), "
"0","         Nin = rep(exp3.loads2$Nin, 6),"
"0","         NP_inflow = rep(exp3.loads2$NP_inflow, 6)) %>%"
"0","  mutate(model = factor(model, levels = c(""Michaelis-Menten"", ""Droop"")), "
"0","         species = factor(species, levels = c(""Diatoms"", ""Greens"", ""Cyanos"")))"
"0",""
"0",""
