"0",""
"0",""
"0","# nutrient loads"
"0","# Olson&Jones use 20 to 500 for P. Use similar values"
"0","# for TP: TP from 2018-219 NLA stream assessment ranges from 2 to 950 ugL with 25th and 7th percentiles of 23 and 133 ugL. DG, August 2024"
"0","# for TN: TN from 2018-2019 NLA Stream Assessment ranges from 22 to 22,000 ugL with 25th and 75th percentiles of 300 and 14,000 ug L; DG, August 2024"
"0","exp3.loads <- expand.grid(Pin = seq(20, 500, 50),"
"0","                                Nin = seq(100, 15000, 500))"
"0",""
"0",""
"0","## michaelis-menten model"
"0","# apply over scenarios and algal groups"
"0","exp.3.mich <-  lapply(list(diatoms.mich, greens.mich, cyanos.mich), function(x) {"
"0","  params <- x"
"0","  lapply(1:nrow(exp3.loads), function(i) {"
"0","    params[""Pin""] = exp3.loads[i, ""Pin""]"
"0","    params[""Nin""] = exp3.loads[i, ""Nin""]"
"0","    y <- c(""A1"" = 100, ""P"" = exp3.loads[i, ""Pin""],""N"" = exp3.loads[i, ""Nin""])"
"0","    run <- ode(y, times, parms = params, func = mich.single)"
"0","    return(run[max(times),])"
"0","  })"
"0","})"
"0","exp3.mich.diatoms <- as_data_frame(do.call(rbind, exp.3.mich[[1]]))"
"0","exp3.mich.greens <- as_data_frame(do.call(rbind, exp.3.mich[[2]]))"
"0","exp3.mich.cyanos <- as_data_frame(do.call(rbind, exp.3.mich[[3]]))"
"0",""
"0","## droop model"
"0","# apply over scenarios and algal groups"
"0","exp.3.droop <-  lapply(list(diatoms.droop, greens.droop, cyanos.droop), function(x) {"
"0","  params <- x"
"0","  lapply(1:nrow(exp3.loads), function(i) {"
"0","    params[""Pin""] = exp3.loads[i, ""Pin""]"
"0","    params[""Nin""] = exp3.loads[i, ""Nin""]"
"0","    y <- c(""A1"" = 100, ""P"" = exp3.loads[i, ""Pin""],""N"" = exp3.loads[i, ""Nin""],"
"0","           ""QP1"" = 0.015, ""QN1"" = 0.1)"
"0","    run <- ode(y, times, parms = params, func = droop.single)"
"0","    return(run[max(times),])"
"0","  })"
"0","})"
"0","exp3.droop.diatoms <- as_data_frame(do.call(rbind, exp.3.droop[[1]]))"
"0","exp3.droop.greens <- as_data_frame(do.call(rbind, exp.3.droop[[2]]))"
"0","exp3.droop.cyanos <- as_data_frame(do.call(rbind, exp.3.droop[[3]]))"
"0",""
"0","# combine everything into a data frame"
"0","exp3.data <- bind_rows("
"0","  exp3.mich.diatoms, exp3.mich.greens, exp3.mich.cyanos,"
"0","  exp3.droop.diatoms, exp3.droop.greens, exp3.droop.cyanos"
"0",") %>%"
"0","  mutate(model = rep(c(""Michaelis-Menten"", ""Droop""), each = nrow(exp3.loads) * 3), "
"0","         species = rep(c(""Diatoms"", ""Greens"", ""Cyanos"", ""Diatoms"", ""Greens"", ""Cyanos""), "
"0","                       each = nrow(exp3.loads)),"
"0","         Pin = rep(exp3.loads$Pin, 6), "
"0","         Nin = rep(exp3.loads$Nin, 6)) %>%"
"0","  mutate(model = factor(model, levels = c(""Michaelis-Menten"", ""Droop"")), "
"0","         species = factor(species, levels = c(""Diatoms"", ""Greens"", ""Cyanos"")))"
"0",""
