"0",""
"0","# nutrient loads"
"0","# P = 0.005 to 0.150 g m^-3 = 5 to 150 mg m^-3"
"0","# N:P = 22.61, 13.57, 9.04, 7.24, 4.52, 2.26  by mass"
"0","exp2.loads <- expand.grid(Pin = seq(5, 150,10),"
"0","                                NP_inflow = c(90.44, 22.61, 7.24, 2.26))"
"0","exp2.loads$Nin <- exp2.loads$Pin * exp2.loads$NP_inflow"
"0",""
"0","## michaelis-menten model"
"0","# apply over scenarios"
"0","exp2.mich <- lapply(1:nrow(exp2.loads), function(i) {"
"0","  params.mich[""Pin""] = exp2.loads[i, ""Pin""]"
"0","  params.mich[""Nin""] = exp2.loads[i, ""Nin""]"
"0","  y <- c(""A1"" = 100,"
"0","         ""P"" = exp2.loads[i, ""Pin""],"
"0","         ""N"" = exp2.loads[i, ""Nin""])"
"0","  "
"0","  run <- ode(y, times, parms = params.mich, func = mich.single)"
"0","  return(run[max(times),])"
"0","  "
"0","})"
"0",""
"0","exp2.mich <- do.call(rbind, exp2.mich)"
"0","exp2.mich <- as_data_frame(exp2.mich)"
"0","exp2.mich$Pin <- exp2.loads$Pin"
"0","exp2.mich$NP_inflow <- exp2.loads$NP_inflow"
"0",""
"0","## droop model"
"0","# apply over scearions"
"0","exp2.droop <- lapply(1:nrow(exp2.loads), function(i) {"
"0","  params.droop[""Pin""] = exp2.loads[i, ""Pin""]"
"0","  params.droop[""Nin""] = exp2.loads[i, ""Nin""]"
"0","  y <- c(""A1"" = 100,"
"0","         ""P"" = exp2.loads[i, ""Pin""],"
"0","         ""N"" = exp2.loads[i, ""Nin""],"
"0","         ""QP1"" = 0.015,"
"0","         ""QN1"" = 0.1)"
"0","  "
"0","  run <- ode(y, times, parms = params.droop, func = droop.single)"
"0","  return(run[max(times),])"
"0","  "
"0","})"
"0",""
"0","exp2.droop <- do.call(rbind, exp2.droop)"
"0","exp2.droop <- as_data_frame(exp2.droop)"
"0","exp2.droop$Pin <- exp2.loads$Pin"
"0","exp2.droop$NP_inflow <- exp2.loads$NP_inflow"
"0",""
"0","## combine data sets for plotting"
"0","exp2.data <- bind_rows("
"0","  exp2.mich %>% mutate(model = ""Michaelis-Menten""),"
"0","  exp2.droop %>% mutate(model = ""Droop"")"
"0",") %>%"
"0","  mutate(model = factor(model, levels = c(""Michaelis-Menten"", ""Droop"")))"
"0",""
