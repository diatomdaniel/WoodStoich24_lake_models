"0","best.run <- lapply(1:nrow(corman2), function(i){"
"0","  # indexing"
"0","  params.mich[""SA""] = pull(corman2[i, ""SA""])"
"0","  params.mich[""DOC""] =  pull(corman2[i, ""DOC_mgL""])"
"0","  params.mich[""z""] =  pull(corman2[i, ""z_m""])"
"0","  params.mich[""KP1""] = pull(best.parm[1, ""KP1""])"
"0","  params.mich[""KN1""] = pull(best.parm[1, ""KN1""])"
"0","  params.mich[""QP1""] = pull(best.parm[1, ""minQP1""])"
"0","  params.mich[""QN1""] = pull(best.parm[1, ""minQN1""])"
"0","  params.mich[""Pin""] = pull(corman2[i, ""TP_load""])"
"0","  params.mich[""Nin""] = pull(corman2[i, ""TN_load""])"
"0","  # starting values"
"0","  y <- c(""A1"" = 100, ""P"" = pull(corman2[i, ""TP_load""]), ""N"" = pull(corman2[i, ""TN_load""]))"
"0","  run <- ode(y, times, parms = params.mich, func = mich.single)"
"0","  return(run[max(times),])"
"0","})"
"0","# convert to df"
"0","best.run <- do.call(rbind, best.run)"
"0","best.run <- as_data_frame(best.run)"
"0","# combine with original df"
"0","best.run <- bind_cols(best.run, corman2)"
"0",""
