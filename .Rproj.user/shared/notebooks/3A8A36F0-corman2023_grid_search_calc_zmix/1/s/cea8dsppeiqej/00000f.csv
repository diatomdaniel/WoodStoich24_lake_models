"0","best.run.droop <- lapply(1:nrow(corman2), function(i){"
"0","  # indexing"
"0","  params.droop[""SA""] = corman2[i, ""SA""]"
"0","  params.droop[""DOC""] = corman2[i, ""DOC_mgL""]"
"0","  params.droop[""z""] = corman2[i, ""z""]"
"0","  params.droop[""KP1""] = pull(best.parm.droop[1, ""KP1""])"
"0","  params.droop[""KN1""] = pull(best.parm.droop[1, ""KN1""])"
"0","  params.droop[""minQP1""] = pull(best.parm.droop[1, ""minQP1""])"
"0","  params.droop[""minQN1""] = pull(best.parm.droop[1, ""minQN1""])"
"0","  params.droop[""upP1""] = pull(best.parm.droop[1, ""upP1""])"
"0","  params.droop[""upN1""] = pull(best.parm.droop[1, ""upN1""])"
"0","  params.droop[""Pin""] = corman2[i, ""TP""]"
"0","  params.droop[""Nin""] = corman2[i, ""TN""]"
"0","  # starting values"
"0","  y <- c(""A1"" = 100, ""P"" = corman2[i, ""TP""], "
"0","         ""N"" = corman2[i, ""TN""],"
"0","          ""QP1"" = 0.015,""QN1"" = 0.1)"
"0","  run <- ode(y, times, parms = params.droop, func = droop.single)"
"0","  return(run[max(times),])"
"0","})"
"0","# convert to df"
"0","best.run.droop <- do.call(rbind, best.run.droop)"
"0","best.run.droop <- as_data_frame(best.run.droop)"
"0","best.run.droop <- rename(best.run.droop, est_GPP = GPP)"
"0","# combine with original df"
"0","best.run.droop <- bind_cols(best.run.droop, corman2)"
