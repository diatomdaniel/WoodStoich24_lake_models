"0","# load data sets"
"0","# GPP"
"0","corman.gpp <- read_csv(""data4input/Corman2023 metabolism result.csv"")"
"0","# stream nutrients "
"0","corman.stream.nutrients  <- read_csv(""data4input/Corman2023 stream nutrients.csv"")"
"0","# volume and DOC created from S1 T1 and T1 in paper"
"0","# no DOC for Lillinonah! used median DOC of the data set = 11.8"
"0","corman.vol <- tibble("
"0","  Lake = c(""Acton"", ""Crampton"", ""EastLong"", ""Feeagh"", ""Harp"", ""Langtjern"", ""Lillinonah"", ""Lillsjoliden"","
"0","           ""Mangstrettjarn"", ""Mendota"", ""Morris"", ""Nastjarn"", ""Ovre"", ""Struptjarn"", ""Trout"", ""Vortsjarv""),"
"0","  z = c(3.9, 5.03, 4.04, 14.50, 13.30, 2, 13, 3.8, 5.3, 12.80, 2.42, 4.20, 4, 3.80, 14.60, 2.80),"
"0","  SA = c(2.5, 0.26, 0.03, 3.92, 0.71, 0.23, 6.26, 0.01, 0.02, 39.60, 0.06, 0.01, 0.05, 0.03, 15.70, 270), "
"0","  DOC_mgL = c(4.3, 4.6, 10.6, 5.6, 5.2, 11.8, 11.8, 15.5, 11.9, 4.7, 17.3, 8.2, 23.2, 19.9, 2.8, 11.9)) %>%"
"0","  mutate(volume_m3 = SA * 1e6 * z)"
"0",""
"0","### aggregate data and conversions"
"0","# GPP"
"0","corman.gpp <- corman.gpp %>%"
"0","  mutate(DateTime = ymd(DateTime),"
"0","         Year = year(DateTime),"
"0","         Month = month(DateTime),"
"0","         GPP = GPP * 12/32) %>%"
"0","  group_by(Lake, Year, Month) %>%"
"0","  summarise("
"0","    GPP = median(GPP, na.rm = T))"
"0","table(is.na(corman.gpp$GPP)) # 12 missing data points, imputed median GPP for a given lake"
"1","
"
"1","FALSE "
"1"," TRUE "
"1","
"
"1","  102 "
"1","   12 "
"1","
"
"0","corman.gpp.filled <- corman.gpp %>%"
"0","  group_by(Lake) %>%"
"0","  mutate(GPP = ifelse(is.na(GPP), median(GPP, na.rm = TRUE), GPP)) %>%"
"0","  ungroup()"
"0",""
"0","# stream nutrients"
"0","corman.stream.nutrients <- corman.stream.nutrients %>%"
"0","  mutate(DateTime = parse_date_time(Datetime, orders = c(""ymd"", ""ymd HMS"")),Year = year(DateTime),"
"0","         Month = month(DateTime)) %>%"
"0","  group_by(Lake, Year, Month) %>%"
"0","  summarise("
"0","    TP = median(TP, na.rm = T),"
"0","    TN = median(TN, na.rm = T))"
"0","# missing 4 observations; imputed the median value for the lake/stream"
"0","# row 22 Feeagh TN and TP in Nov 2013"
"0","# row 97 Trout TN in June 2013"
"0","# row 98 Trout TP in June August"
"0","# row 100 Trout TP in July 2013"
"0","corman.stream.nutrients.filled <- corman.stream.nutrients %>%"
"0","  group_by(Lake) %>%"
"0","  mutate(TN = ifelse(is.na(TN), median(TN, na.rm = TRUE), TN),"
"0","         TP = ifelse(is.na(TP), median(TP, na.rm = TRUE), TP)) %>%"
"0","  ungroup()"
"0",""
"0","## combine data sets"
"0","corman2 <- merge(corman.gpp.filled,"
"0","                 corman.stream.nutrients.filled, by = c(""Lake"", ""Year"", ""Month""))"
"0","corman2 <- merge(corman2, corman.vol, by = ""Lake"")"
"0",""
"0","# add calculated zmix"
"0","corman2$zmix <- 10^(-0.515 + log10(corman2$DOC_mgL) + 0.115 * log10(2 * sqrt(corman2$SA/pi + 0.991)))"
"0","corman2$zmix <- ifelse(corman2$zmix > corman2$z_m, corman2$z, corman2$zmix)"
"2","Error in `$<-.data.frame`(`*tmp*`, zmix, value = logical(0)) : 
  replacement has 0 rows, data has 91
"
