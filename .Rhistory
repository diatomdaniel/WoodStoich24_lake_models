lwd = 1, lty = "dashed") +
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = 0, yend = GPP, col = species),
lwd = 0.75, lty = "dashed") +
# geom_line(data = average, aes(NP_inflow, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = average, aes(NP_inflow, GPP, fill = Pin, group = Pin), pch = 21, size = 2) +
# geom_line(data = diatoms, aes(NP_inflow, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = diatoms, aes(NP_inflow, GPP, fill = Pin, group = Pin), pch = 22, size = 2) +
# geom_line(data = greens, aes(NP_inflow, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = greens, aes(NP_inflow, GPP, fill = Pin, group = Pin), pch = 23, size = 2) +
# geom_line(data = cyanos, aes(NP_inflow, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = cyanos, aes(NP_inflow, GPP, fill = Pin, group = Pin), pch = 24, size = 2) +
#geom_vline(data = consump.vctr, aes(xintercept = minQN_minQP), lwd = 0.75, lty = "dashed") +
geom_line(data = gpp.sims, aes(x = NP_inflow, y = GPP,
col = species, group = interaction(species, Pin)),
lwd = 0.75) +
geom_point(data = gpp.sims, aes(x = NP_inflow, y = GPP,
fill = species, pch = Pin, group = Pin),
size = 2, col = "black") +
scale_x_log10() + scale_y_log10() +
ggh4x::facet_grid2(.~model) +
scale_shape_manual(values = 21:23) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
#guides(fill = "none", col = "none") +
labs(x = "N:P inflow mass", y = "GPP mg C L^-1 day^-1", col = "P in ug L^-1"))
# plot GPP across supply N:P for each species
(gpp.plt <- ggplot() +
# # add in the consumption vctrs ala Tilmann
# note that consumption vctrs won't match for the static model, only the dynamic as cell quotas change..
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = minQN_minQP, yend = 0, col = species),
lwd = 1, lty = "dashed") +
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = 0, yend = GPP, col = species),
lwd = 0.75, lty = "dashed") +
# geom_line(data = average, aes(NP_inflow, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = average, aes(NP_inflow, GPP, fill = Pin, group = Pin), pch = 21, size = 2) +
# geom_line(data = diatoms, aes(NP_inflow, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = diatoms, aes(NP_inflow, GPP, fill = Pin, group = Pin), pch = 22, size = 2) +
# geom_line(data = greens, aes(NP_inflow, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = greens, aes(NP_inflow, GPP, fill = Pin, group = Pin), pch = 23, size = 2) +
# geom_line(data = cyanos, aes(NP_inflow, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = cyanos, aes(NP_inflow, GPP, fill = Pin, group = Pin), pch = 24, size = 2) +
#geom_vline(data = consump.vctr, aes(xintercept = minQN_minQP), lwd = 0.75, lty = "dashed") +
geom_line(data = gpp.sims, aes(x = NP_inflow, y = GPP,
col = species, group = interaction(species, Pin)),
lwd = 0.75) +
geom_point(data = gpp.sims, aes(x = NP_inflow, y = GPP,
fill = species, pch = Pin, group = Pin),
size = 2, col = "black") +
scale_x_log10() + scale_y_log10() +
ggh4x::facet_grid2(.~model) +
scale_shape_manual(values = c(21, 22, 24)) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
guides(col = "none") +
labs(x = "N:P inflow mass", y = "GPP mg C L^-1 day^-1", col = "P in ug L^-1"))
# plot GPP across supply N:P for each species
(gpp.plt <- ggplot() +
# # add in the consumption vctrs ala Tilmann
# note that consumption vctrs won't match for the static model, only the dynamic as cell quotas change..
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = minQN_minQP, yend = 0, col = species),
lwd = 1, lty = "dashed") +
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = 0, yend = GPP, col = species),
lwd = 0.75, lty = "dashed") +
# geom_line(data = average, aes(NP_inflow, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = average, aes(NP_inflow, GPP, fill = Pin, group = Pin), pch = 21, size = 2) +
# geom_line(data = diatoms, aes(NP_inflow, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = diatoms, aes(NP_inflow, GPP, fill = Pin, group = Pin), pch = 22, size = 2) +
# geom_line(data = greens, aes(NP_inflow, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = greens, aes(NP_inflow, GPP, fill = Pin, group = Pin), pch = 23, size = 2) +
# geom_line(data = cyanos, aes(NP_inflow, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = cyanos, aes(NP_inflow, GPP, fill = Pin, group = Pin), pch = 24, size = 2) +
#geom_vline(data = consump.vctr, aes(xintercept = minQN_minQP), lwd = 0.75, lty = "dashed") +
geom_line(data = gpp.sims, aes(x = NP_inflow, y = GPP,
col = species, group = interaction(species, Pin)),
lwd = 0.75) +
geom_point(data = gpp.sims, aes(x = NP_inflow, y = GPP,
fill = species, pch = Pin, group = Pin),
size = 2) +
scale_x_log10() + scale_y_log10() +
ggh4x::facet_grid2(.~model) +
scale_shape_manual(values = c(21, 22, 24)) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
labs(x = "N:P inflow mass", y = "GPP mg C L^-1 day^-1", col = "P in ug L^-1"))
# plot GPP across supply N:P for each species
(gpp.plt <- ggplot() +
# # add in the consumption vctrs ala Tilmann
# note that consumption vctrs won't match for the static model, only the dynamic as cell quotas change..
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = minQN_minQP, yend = 0, col = species),
lwd = 1, lty = "dashed") +
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = 0, yend = GPP, col = species),
lwd = 0.75, lty = "dashed") +
# geom_line(data = average, aes(NP_inflow, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = average, aes(NP_inflow, GPP, fill = Pin, group = Pin), pch = 21, size = 2) +
# geom_line(data = diatoms, aes(NP_inflow, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = diatoms, aes(NP_inflow, GPP, fill = Pin, group = Pin), pch = 22, size = 2) +
# geom_line(data = greens, aes(NP_inflow, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = greens, aes(NP_inflow, GPP, fill = Pin, group = Pin), pch = 23, size = 2) +
# geom_line(data = cyanos, aes(NP_inflow, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = cyanos, aes(NP_inflow, GPP, fill = Pin, group = Pin), pch = 24, size = 2) +
#geom_vline(data = consump.vctr, aes(xintercept = minQN_minQP), lwd = 0.75, lty = "dashed") +
geom_line(data = gpp.sims, aes(x = NP_inflow, y = GPP,
col = species, group = interaction(Pin)),
lwd = 0.75) +
geom_point(data = gpp.sims, aes(x = NP_inflow, y = GPP,
fill = species, pch = Pin, group = Pin),
size = 2) +
scale_x_log10() + scale_y_log10() +
ggh4x::facet_grid2(.~model) +
scale_shape_manual(values = c(21, 22, 24)) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
labs(x = "N:P inflow mass", y = "GPP mg C L^-1 day^-1", col = "P in ug L^-1"))
# plot GPP across supply N:P for each species
(gpp.plt <- ggplot() +
# # add in the consumption vctrs ala Tilmann
# note that consumption vctrs won't match for the static model, only the dynamic as cell quotas change..
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = minQN_minQP, yend = 0, col = species),
lwd = 1, lty = "dashed") +
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = 0, yend = GPP, col = species),
lwd = 0.75, lty = "dashed") +
# geom_line(data = average, aes(NP_inflow, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = average, aes(NP_inflow, GPP, fill = Pin, group = Pin), pch = 21, size = 2) +
# geom_line(data = diatoms, aes(NP_inflow, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = diatoms, aes(NP_inflow, GPP, fill = Pin, group = Pin), pch = 22, size = 2) +
# geom_line(data = greens, aes(NP_inflow, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = greens, aes(NP_inflow, GPP, fill = Pin, group = Pin), pch = 23, size = 2) +
# geom_line(data = cyanos, aes(NP_inflow, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = cyanos, aes(NP_inflow, GPP, fill = Pin, group = Pin), pch = 24, size = 2) +
#geom_vline(data = consump.vctr, aes(xintercept = minQN_minQP), lwd = 0.75, lty = "dashed") +
geom_line(data = gpp.sims, aes(x = NP_inflow, y = GPP,
col = species, group = interaction(species, Pin)),
lwd = 0.75) +
geom_point(data = gpp.sims, aes(x = NP_inflow, y = GPP,
fill = species, pch = Pin, group = Pin),
size = 2) +
scale_x_log10() + scale_y_log10() +
ggh4x::facet_grid2(.~model) +
scale_shape_manual(values = c(21, 22, 24)) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
labs(x = "N:P inflow mass", y = "GPP mg C L^-1 day^-1", col = "P in ug L^-1"))
# plot CNP across supply N:P for each species
(cnp.plt <- ggplot() +
# add in the consumption vctrs ala Tilmann
geom_segment(data = consump.vctr.seston,
aes(y = CNP, x = minQN_minQP, xend = minQN_minQP, yend = 0, col = spcies),
lwd = 1, lty = "dashed") +
geom_segment(data = consump.vctr.seston,
aes(y = CNP, x = minQN_minQP, xend = 0, yend = CNP, col = species),
lwd = 1, lty = "dashed") +
# data
# geom_line(data = seston.average, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.average, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 21, size = 2) +
# geom_line(data = seston.diatoms, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.diatoms, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 22, size = 2) +
# geom_line(data = seston.greens, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.greens, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 23, size = 2) +
# geom_line(data = seston.cyanos, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.cyanos, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 24, size = 2) +
geom_line(data = seston, aes(NP_inflow, value, col = species, group = interaction(species, Pin)),
lwd = 0.75) +
geom_point(data = seston, aes(NP_inflow, value, fill = species, pch = Pin, group = Pin), size = 2) +
scale_x_log10() + scale_y_log10() +
ggh4x::facet_grid2(.~seston) +
scale_shape_manual(values = 21:24, labels = species.legend) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
guides(fill = "none", col = "none") +
labs(x = "N:P inflow mass", y = "C:N:P", col = "P in ug L^-1"))
# plot CNP across supply N:P for each species
(cnp.plt <- ggplot() +
# add in the consumption vctrs ala Tilmann
geom_segment(data = consump.vctr.seston,
aes(y = CNP, x = minQN_minQP, xend = minQN_minQP, yend = 0, col = species),
lwd = 1, lty = "dashed") +
geom_segment(data = consump.vctr.seston,
aes(y = CNP, x = minQN_minQP, xend = 0, yend = CNP, col = species),
lwd = 1, lty = "dashed") +
# data
# geom_line(data = seston.average, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.average, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 21, size = 2) +
# geom_line(data = seston.diatoms, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.diatoms, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 22, size = 2) +
# geom_line(data = seston.greens, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.greens, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 23, size = 2) +
# geom_line(data = seston.cyanos, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.cyanos, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 24, size = 2) +
geom_line(data = seston, aes(NP_inflow, value, col = species, group = interaction(species, Pin)),
lwd = 0.75) +
geom_point(data = seston, aes(NP_inflow, value, fill = species, pch = Pin, group = Pin), size = 2) +
scale_x_log10() + scale_y_log10() +
ggh4x::facet_grid2(.~seston) +
scale_shape_manual(values = 21:24, labels = species.legend) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
guides(fill = "none", col = "none") +
labs(x = "N:P inflow mass", y = "C:N:P", col = "P in ug L^-1"))
# plot CNP across supply N:P for each species
(cnp.plt <- ggplot() +
# add in the consumption vctrs ala Tilmann
geom_segment(data = consump.vctr.seston,
aes(y = CNP, x = minQN_minQP, xend = minQN_minQP, yend = 0, col = species),
lwd = 1, lty = "dashed") +
geom_segment(data = consump.vctr.seston,
aes(y = CNP, x = minQN_minQP, xend = 0, yend = CNP, col = species),
lwd = 1, lty = "dashed") +
# data
# geom_line(data = seston.average, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.average, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 21, size = 2) +
# geom_line(data = seston.diatoms, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.diatoms, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 22, size = 2) +
# geom_line(data = seston.greens, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.greens, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 23, size = 2) +
# geom_line(data = seston.cyanos, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.cyanos, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 24, size = 2) +
geom_line(data = seston, aes(NP_inflow, value, col = species, group = interaction(species, Pin)),
lwd = 0.75) +
geom_point(data = seston, aes(NP_inflow, value, fill = species, pch = Pin, group = Pin), size = 2) +
scale_x_log10() + scale_y_log10() +
ggh4x::facet_grid2(.~seston) +
scale_shape_manual(values = c(21, 22, 23)) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
labs(x = "N:P inflow mass", y = "C:N:P", col = "P in ug L^-1"))
# plot CNP across supply N:P for each species
(cnp.plt <- ggplot() +
# add in the consumption vctrs ala Tilmann
geom_segment(data = consump.vctr.seston,
aes(y = CNP, x = minQN_minQP, xend = minQN_minQP, yend = 0, col = species),
lwd = 1, lty = "dashed") +
geom_segment(data = consump.vctr.seston,
aes(y = CNP, x = minQN_minQP, xend = 0, yend = CNP, col = species),
lwd = 1, lty = "dashed") +
# data
# geom_line(data = seston.average, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.average, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 21, size = 2) +
# geom_line(data = seston.diatoms, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.diatoms, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 22, size = 2) +
# geom_line(data = seston.greens, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.greens, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 23, size = 2) +
# geom_line(data = seston.cyanos, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.cyanos, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 24, size = 2) +
geom_line(data = seston, aes(NP_inflow, value, col = species, group = interaction(species, Pin)),
lwd = 0.75) +
geom_point(data = seston, aes(NP_inflow, value, fill = species, pch = Pin, group = Pin), size = 2) +
scale_x_log10() + scale_y_log10() +
ggh4x::facet_grid2(.~seston, scales = "free", independent = "y") +
scale_shape_manual(values = c(21, 22, 23)) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
labs(x = "N:P inflow mass", y = "C:N:P", col = "P in ug L^-1"))
# plot CNP across supply N:P for each species
(cnp.plt <- ggplot() +
# add in the consumption vctrs ala Tilmann
geom_segment(data = consump.vctr.seston,
aes(y = CNP, x = minQN_minQP, xend = minQN_minQP, yend = 0, col = species),
lwd = 1, lty = "dashed") +
geom_segment(data = consump.vctr.seston,
aes(y = CNP, x = minQN_minQP, xend = 0, yend = CNP, col = species),
lwd = 1, lty = "dashed") +
# data
# geom_line(data = seston.average, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.average, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 21, size = 2) +
# geom_line(data = seston.diatoms, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.diatoms, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 22, size = 2) +
# geom_line(data = seston.greens, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.greens, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 23, size = 2) +
# geom_line(data = seston.cyanos, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.cyanos, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 24, size = 2) +
geom_line(data = seston, aes(NP_inflow, value, col = species, group = interaction(species, Pin)),
lwd = 0.75) +
geom_point(data = seston, aes(NP_inflow, value, fill = species, pch = Pin, group = Pin), size = 2) +
scale_x_log10() + #scale_y_log10() +
ggh4x::facet_grid2(.~seston, scales = "free", independent = "y") +
scale_shape_manual(values = c(21, 22, 23)) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
labs(x = "N:P inflow mass", y = "C:N:P", col = "P in ug L^-1"))
# plot CNP across supply N:P for each species
(cnp.plt <- ggplot() +
# add in the consumption vctrs ala Tilmann
geom_segment(data = consump.vctr.seston,
aes(y = CNP, x = minQN_minQP, xend = minQN_minQP, yend = 0, col = species),
lwd = 1, lty = "dashed") +
geom_segment(data = consump.vctr.seston,
aes(y = CNP, x = minQN_minQP, xend = 0, yend = CNP, col = species),
lwd = 1, lty = "dashed") +
# data
# geom_line(data = seston.average, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.average, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 21, size = 2) +
# geom_line(data = seston.diatoms, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.diatoms, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 22, size = 2) +
# geom_line(data = seston.greens, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.greens, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 23, size = 2) +
# geom_line(data = seston.cyanos, aes(NP_inflow, value, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.cyanos, aes(NP_inflow, value, fill = Pin, group = Pin), pch = 24, size = 2) +
geom_line(data = seston, aes(NP_inflow, value, col = species, group = interaction(species, Pin)),
lwd = 0.75) +
geom_point(data = seston, aes(NP_inflow, value, fill = species, pch = Pin, group = Pin), size = 2) +
scale_x_log10() + scale_y_log10() +
ggh4x::facet_grid2(.~seston, scales = "free", independent = "y") +
scale_shape_manual(values = c(21, 22, 23)) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
labs(x = "N:P inflow mass", y = "C:N:P", col = "P in ug L^-1"))
(gpp.cnp.plt <- ggplot() +
# # add in the consumption vctrs ala Tilmann
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = minQN_minQP, yend = 0, col = species),
lwd = 0.75, lty = "dashed") +
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = 0, yend = GPP, col = species),
lwd = 0.75, lty = "dashed") +
# data
# geom_line(data = seston.average, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.average, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 21, size = 2) +
# geom_line(data = seston.diatoms, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.diatoms, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 22, size = 2) +
# geom_line(data = seston.greens, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.greens, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 23, size = 2) +
# geom_line(data = seston.cyanos, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.cyanos, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 24, size = 2) +
geom_line(data = seston, aes(value, GPP, col = species, alpha = NP_inflow, group = interaction(species, Pin)),
lwd = 0.75) +
geom_point(data = seston, aes(value, GPP, fill = species, alpha = NP_inflow, group = interaction(species, Pin)),
size = 2) +
scale_x_log10() + scale_y_log10() +
ggh4x::facet_grid2(.~seston) +
scale_shape_manual(values = 21:24, labels = species.legend) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
guides(fill = "none", col = "none", "alpha" = "none") +
labs(x = "C:N:P molar", y = "GPP mg C L^-1 day_1", col = "P in ug L^-1", size = "Inflow log(N:P) mass"))
(gpp.cnp.plt <- ggplot() +
# # add in the consumption vctrs ala Tilmann
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = minQN_minQP, yend = 0, col = species),
lwd = 0.75, lty = "dashed") +
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = 0, yend = GPP, col = species),
lwd = 0.75, lty = "dashed") +
# data
# geom_line(data = seston.average, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.average, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 21, size = 2) +
# geom_line(data = seston.diatoms, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.diatoms, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 22, size = 2) +
# geom_line(data = seston.greens, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.greens, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 23, size = 2) +
# geom_line(data = seston.cyanos, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.cyanos, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 24, size = 2) +
geom_line(data = seston, aes(value, GPP, col = species, alpha = NP_inflow, group = interaction(species, Pin)),
lwd = 0.75) +
geom_point(data = seston, aes(value, GPP, fill = species, alpha = NP_inflow, group = interaction(species, Pin)),
size = 2) +
scale_x_log10() + scale_y_log10() +
ggh4x::facet_grid2(.~seston) +
scale_shape_manual(values = c(21, 22, 24)) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
labs(x = "C:N:P molar", y = "GPP mg C L^-1 day_1", col = "P in ug L^-1", size = "Inflow log(N:P) mass"))
(gpp.cnp.plt <- ggplot() +
# # add in the consumption vctrs ala Tilmann
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = minQN_minQP, yend = 0, col = species),
lwd = 0.75, lty = "dashed") +
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = 0, yend = GPP, col = species),
lwd = 0.75, lty = "dashed") +
# data
# geom_line(data = seston.average, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.average, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 21, size = 2) +
# geom_line(data = seston.diatoms, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.diatoms, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 22, size = 2) +
# geom_line(data = seston.greens, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.greens, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 23, size = 2) +
# geom_line(data = seston.cyanos, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.cyanos, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 24, size = 2) +
geom_line(data = seston, aes(value, GPP, col = species, alpha = NP_inflow, group = interaction(species, Pin)),
lwd = 0.75) +
geom_point(data = seston, aes(value, GPP, fill = species, pch = Pin, alpha = NP_inflow, group = interaction(species, Pin)),
size = 2) +
scale_x_log10() + scale_y_log10() +
ggh4x::facet_grid2(.~seston) +
scale_shape_manual(values = c(21, 22, 24)) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
labs(x = "C:N:P molar", y = "GPP mg C L^-1 day_1", col = "P in ug L^-1", size = "Inflow log(N:P) mass"))
(gpp.cnp.plt <- ggplot() +
# # add in the consumption vctrs ala Tilmann
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = minQN_minQP, yend = 0, col = species),
lwd = 0.75, lty = "dashed") +
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = 0, yend = GPP, col = species),
lwd = 0.75, lty = "dashed") +
# data
# geom_line(data = seston.average, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.average, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 21, size = 2) +
# geom_line(data = seston.diatoms, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.diatoms, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 22, size = 2) +
# geom_line(data = seston.greens, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.greens, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 23, size = 2) +
# geom_line(data = seston.cyanos, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.cyanos, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 24, size = 2) +
geom_line(data = seston, aes(value, GPP, col = species, alpha = NP_inflow, group = interaction(species, Pin)),
lwd = 0.75) +
geom_point(data = seston, aes(value, GPP, fill = species, pch = Pin, alpha = NP_inflow, group = interaction(species, Pin)),
size = 2) +
scale_x_log10() + scale_y_log10() +
ggh4x::facet_grid2(.~seston) +
scale_shape_manual(values = c(21, 22, 24)) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
scale_alpha(range=c(0,1), limits=c(0.5,1), na.value = 0) +
labs(x = "C:N:P molar", y = "GPP mg C L^-1 day_1", col = "P in ug L^-1", size = "Inflow log(N:P) mass"))
(gpp.cnp.plt <- ggplot() +
# # add in the consumption vctrs ala Tilmann
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = minQN_minQP, yend = 0, col = species),
lwd = 0.75, lty = "dashed") +
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = 0, yend = GPP, col = species),
lwd = 0.75, lty = "dashed") +
# data
# geom_line(data = seston.average, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.average, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 21, size = 2) +
# geom_line(data = seston.diatoms, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.diatoms, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 22, size = 2) +
# geom_line(data = seston.greens, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.greens, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 23, size = 2) +
# geom_line(data = seston.cyanos, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.cyanos, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 24, size = 2) +
geom_line(data = seston, aes(value, GPP, col = species, alpha = NP_inflow, group = interaction(species, Pin)),
lwd = 0.75) +
geom_point(data = seston, aes(value, GPP, fill = species, pch = Pin, alpha = NP_inflow, group = interaction(species, Pin)),
size = 2) +
scale_x_log10() + scale_y_log10() +
ggh4x::facet_grid2(.~seston) +
scale_shape_manual(values = c(21, 22, 24)) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
scale_alpha(limits=c(0.5,1), na.value = 0) +
labs(x = "C:N:P molar", y = "GPP mg C L^-1 day_1", col = "P in ug L^-1", size = "Inflow log(N:P) mass"))
(gpp.cnp.plt <- ggplot() +
# # add in the consumption vctrs ala Tilmann
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = minQN_minQP, yend = 0, col = species),
lwd = 0.75, lty = "dashed") +
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = 0, yend = GPP, col = species),
lwd = 0.75, lty = "dashed") +
# data
# geom_line(data = seston.average, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.average, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 21, size = 2) +
# geom_line(data = seston.diatoms, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.diatoms, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 22, size = 2) +
# geom_line(data = seston.greens, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.greens, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 23, size = 2) +
# geom_line(data = seston.cyanos, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.cyanos, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 24, size = 2) +
geom_line(data = seston, aes(value, GPP, col = species, alpha = NP_inflow, group = interaction(species, Pin)),
lwd = 0.75) +
geom_point(data = seston, aes(value, GPP, fill = species, pch = Pin, alpha = NP_inflow, group = interaction(species, Pin)),
size = 2) +
scale_x_log10() + scale_y_log10() +
ggh4x::facet_grid2(.~seston) +
scale_shape_manual(values = c(21, 22, 24)) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
scale_alpha(range=c(0.5,1), na.value = 0) +
labs(x = "C:N:P molar", y = "GPP mg C L^-1 day_1", col = "P in ug L^-1", size = "Inflow log(N:P) mass"))
# plot GPP across CNP for each species
# quick edit to consumption vctr.
consump.vctr.seston <- consump.vctr.seston %>% mutate(minQN_minQP = ifelse(seston == "N:P", minQN_minQP, NA))
(gpp.cnp.plt <- ggplot() +
# # add in the consumption vctrs ala Tilmann
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = minQN_minQP, yend = 0, col = species),
lwd = 0.75, lty = "dashed") +
geom_segment(data = consump.vctr.seston,
aes(y = GPP, x = minQN_minQP, xend = 0, yend = GPP, col = species),
lwd = 0.75, lty = "dashed") +
# data
# geom_line(data = seston.average, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.average, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 21, size = 2) +
# geom_line(data = seston.diatoms, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.diatoms, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 22, size = 2) +
# geom_line(data = seston.greens, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.greens, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 23, size = 2) +
# geom_line(data = seston.cyanos, aes(value, GPP, col = Pin, group = Pin), lwd = 1) +
# geom_point(data = seston.cyanos, aes(value, GPP, fill = Pin, group = Pin, alpha = log(NP_inflow)), pch = 24, size = 2) +
geom_line(data = seston, aes(value, GPP, col = species, alpha = NP_inflow, group = interaction(species, Pin)),
lwd = 0.75) +
geom_point(data = seston, aes(value, GPP, fill = species, pch = Pin, alpha = NP_inflow, group = interaction(species, Pin)),
size = 2) +
scale_x_log10() + scale_y_log10() +
ggh4x::facet_grid2(.~seston) +
scale_shape_manual(values = c(21, 22, 24)) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
scale_alpha(range=c(0.5,1), na.value = 0) +
labs(x = "C:N:P molar", y = "GPP mg C L^-1 day_1", col = "P in ug L^-1", size = "Inflow log(N:P) mass"))
